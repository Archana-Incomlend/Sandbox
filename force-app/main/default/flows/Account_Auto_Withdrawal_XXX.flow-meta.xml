<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <apiVersion>55.0</apiVersion>
    <decisions>
        <name>If_Buyer</name>
        <label>If Buyer</label>
        <locationX>692</locationX>
        <locationY>669</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Account_Name_Unique_Index_Buyer</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Account_Name_for_unique_index__c</leftValueReference>
                <operator>Contains</operator>
                <rightValue>
                    <stringValue>Buyer</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>New_CCY_CL_to_old_CCY_Cl</targetReference>
            </connector>
            <label>Account Name Unique Index = Buyer</label>
        </rules>
    </decisions>
    <decisions>
        <name>Shipping_Address_same_billing_address</name>
        <label>Shipping Address same billing address</label>
        <locationX>665</locationX>
        <locationY>498</locationY>
        <defaultConnector>
            <targetReference>If_Buyer</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Shipping_Address_Billing_Address</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Address_Shipping_is_Address_Billing__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Update_shipping_Address</targetReference>
            </connector>
            <label>Shipping Address = Billing Address</label>
        </rules>
    </decisions>
    <decisions>
        <name>When_checkbox_is_ticked</name>
        <label>When checkbox is ticked</label>
        <locationX>95</locationX>
        <locationY>340</locationY>
        <defaultConnector>
            <targetReference>Shipping_Address_same_billing_address</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Checkbox_is_Ticked</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Ready_for_Withdrawal__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Sub_type__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Supplier</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.onboarding_approved__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.XXX_Available_eWallet__c</leftValueReference>
                <operator>GreaterThan</operator>
                <rightValue>
                    <numberValue>0.0</numberValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Create_Transaction</targetReference>
            </connector>
            <doesRequireRecordChangedToMeetCriteria>true</doesRequireRecordChangedToMeetCriteria>
            <label>Checkbox is Ticked</label>
        </rules>
    </decisions>
    <environments>Default</environments>
    <formulas>
        <name>Amount</name>
        <dataType>Currency</dataType>
        <expression>-1 * {!$Record.XXX_Available_eWallet__c}</expression>
        <scale>2</scale>
    </formulas>
    <interviewLabel>Account - Auto Withdrawal XXX {!$Flow.CurrentDateTime}</interviewLabel>
    <label>Account - Auto Withdrawal XXX</label>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>FREE_FORM_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>AutoLaunchedFlow</processType>
    <recordCreates>
        <name>Create_Transaction</name>
        <label>Create Transaction</label>
        <locationX>220</locationX>
        <locationY>472</locationY>
        <connector>
            <targetReference>Shipping_Address_same_billing_address</targetReference>
        </connector>
        <inputAssignments>
            <field>Account__c</field>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Amount__c</field>
            <value>
                <elementReference>Amount</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>CCY__c</field>
            <value>
                <stringValue>XXX</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Effective_Date__c</field>
            <value>
                <elementReference>$Flow.CurrentDate</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Status__c</field>
            <value>
                <stringValue>Requested</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Type__c</field>
            <value>
                <stringValue>80.Withdrawal</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>notes__c</field>
            <value>
                <stringValue>Daily Auto Withdrawal</stringValue>
            </value>
        </inputAssignments>
        <object>Transaction__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordUpdates>
        <name>New_CCY_CL_to_old_CCY_Cl</name>
        <label>New CCY CL to old CCY Cl</label>
        <locationX>269</locationX>
        <locationY>794</locationY>
        <inputAssignments>
            <field>Credit_Insurance_CCY__c</field>
            <value>
                <elementReference>$Record.Credit_Limit_Requested_CCY__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Credit_limit_insurance_currency__c</field>
            <value>
                <elementReference>$Record.Total_CL_Limit_from_Incomlend__c</elementReference>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Update_shipping_Address</name>
        <label>Update shipping Address</label>
        <locationX>158</locationX>
        <locationY>620</locationY>
        <connector>
            <targetReference>If_Buyer</targetReference>
        </connector>
        <inputAssignments>
            <field>ShippingCity</field>
            <value>
                <elementReference>$Record.BillingCity</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>ShippingCountry</field>
            <value>
                <elementReference>$Record.BillingCountry</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>ShippingGeocodeAccuracy</field>
            <value>
                <elementReference>$Record.BillingGeocodeAccuracy</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>ShippingLatitude</field>
            <value>
                <elementReference>$Record.BillingLatitude</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>ShippingLongitude</field>
            <value>
                <elementReference>$Record.BillingLatitude</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>ShippingPostalCode</field>
            <value>
                <elementReference>$Record.BillingPostalCode</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>ShippingState</field>
            <value>
                <elementReference>$Record.BillingState</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>ShippingStreet</field>
            <value>
                <elementReference>$Record.BillingStreet</elementReference>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <start>
        <locationX>410</locationX>
        <locationY>48</locationY>
        <connector>
            <targetReference>When_checkbox_is_ticked</targetReference>
        </connector>
        <object>Account</object>
        <recordTriggerType>CreateAndUpdate</recordTriggerType>
        <triggerType>RecordAfterSave</triggerType>
    </start>
    <status>Obsolete</status>
</Flow>
