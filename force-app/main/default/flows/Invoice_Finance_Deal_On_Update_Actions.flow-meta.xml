<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <actionCalls>
        <description>An invoice is ready for posting, please create the Allocation</description>
        <name>An_invoice_is_ready_for_posting</name>
        <label>An invoice is ready for posting</label>
        <locationX>50</locationX>
        <locationY>5351</locationY>
        <actionName>NewTask</actionName>
        <actionType>quickAction</actionType>
        <connector>
            <targetReference>Waiting_for_Allocations_date</targetReference>
        </connector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>OwnerId</name>
            <value>
                <elementReference>Get_User_Rish_Piilay.Id</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>ActivityDate</name>
            <value>
                <elementReference>ReadyForPostingDate</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>WhatId</name>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>Status</name>
            <value>
                <stringValue>Not Started</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>Subject</name>
            <value>
                <stringValue>An invoice is ready for posting - please create the Allocation</stringValue>
            </value>
        </inputParameters>
    </actionCalls>
    <actionCalls>
        <description>The invoice has been approved by the Supplier , please prepare the allocations</description>
        <name>Invoice_approved_by_Supplier</name>
        <label>Invoice approved by Supplier</label>
        <locationX>50</locationX>
        <locationY>2519</locationY>
        <actionName>NewTask</actionName>
        <actionType>quickAction</actionType>
        <connector>
            <targetReference>Get_User_Rish_Piilay</targetReference>
        </connector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>OwnerId</name>
            <value>
                <elementReference>Get_User_Mohd_Asif.Id</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>ActivityDate</name>
            <value>
                <elementReference>DueDate</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>contextId</name>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>Status</name>
            <value>
                <stringValue>Not Started</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>Subject</name>
            <value>
                <stringValue>Invoice approved by Supplier</stringValue>
            </value>
        </inputParameters>
    </actionCalls>
    <actionCalls>
        <description>An invoice is ready for posting, please create the Allocation</description>
        <name>Invoice_ready_for_posting</name>
        <label>Invoice ready for posting</label>
        <locationX>50</locationX>
        <locationY>5015</locationY>
        <actionName>NewTask</actionName>
        <actionType>quickAction</actionType>
        <connector>
            <targetReference>Check_for_Rish_s_User</targetReference>
        </connector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>OwnerId</name>
            <value>
                <elementReference>Get_User_Mohd_Asif.Id</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>ActivityDate</name>
            <value>
                <elementReference>Invoice_ready_for_posting_Due_Date</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>WhatId</name>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>Status</name>
            <value>
                <stringValue>Not Started</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>Subject</name>
            <value>
                <stringValue>An invoice is ready for posting, please create the Allocation</stringValue>
            </value>
        </inputParameters>
    </actionCalls>
    <actionCalls>
        <description>The invoice has been approved by the Supplier , please prepare the allocations</description>
        <name>Supplier_Approved_Invoice_Assign_to_Rish</name>
        <label>Supplier Approved Invoice - Assign to Rish</label>
        <locationX>50</locationX>
        <locationY>2975</locationY>
        <actionName>NewTask</actionName>
        <actionType>quickAction</actionType>
        <connector>
            <targetReference>External_View_Equals_True</targetReference>
        </connector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>OwnerId</name>
            <value>
                <elementReference>Get_User_Rish_Piilay.Id</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>ActivityDate</name>
            <value>
                <elementReference>DueDate</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>contextId</name>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>Status</name>
            <value>
                <stringValue>Not Started</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>Subject</name>
            <value>
                <stringValue>Invoice approved by Supplier</stringValue>
            </value>
        </inputParameters>
    </actionCalls>
    <apiVersion>51.0</apiVersion>
    <decisions>
        <name>Allocation_Number_Greater_than_0_and_Phase_is_Pre_Listing</name>
        <label>Allocation Number Greater than 0 and Phase is Pre Listing</label>
        <locationX>336</locationX>
        <locationY>1487</locationY>
        <defaultConnector>
            <targetReference>Funds_Available_Is_True</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Allocation_Number_0_and_Phase_Pre_Listing</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.allocation_number__c</leftValueReference>
                <operator>GreaterThan</operator>
                <rightValue>
                    <numberValue>0.0</numberValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Phase__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>1:PRE LISTING</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Send_Slack_Allocation</targetReference>
            </connector>
            <doesRequireRecordChangedToMeetCriteria>true</doesRequireRecordChangedToMeetCriteria>
            <label>Allocation Number &gt; 0 and Phase = Pre Listing</label>
        </rules>
    </decisions>
    <decisions>
        <name>Check_for_Asif_s_User</name>
        <label>Check for Asif&apos;s User</label>
        <locationX>182</locationX>
        <locationY>4895</locationY>
        <defaultConnector>
            <targetReference>Check_for_Rish_s_User</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Asif_s_User_is_Active_0</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_User_Mohd_Asif.Id</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Invoice_ready_for_posting</targetReference>
            </connector>
            <label>Asif&apos;s User is Active</label>
        </rules>
    </decisions>
    <decisions>
        <name>Check_for_Rish_s_User</name>
        <label>Check for Rish&apos;s User</label>
        <locationX>182</locationX>
        <locationY>5231</locationY>
        <defaultConnector>
            <targetReference>Waiting_for_Allocations_date</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Rish_s_User_is_Active</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_User_Rish_Piilay.Id</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>An_invoice_is_ready_for_posting</targetReference>
            </connector>
            <label>Rish&apos;s User is Active</label>
        </rules>
    </decisions>
    <decisions>
        <name>Check_for_supplier_buyer_map</name>
        <label>Check for supplier buyer map</label>
        <locationX>534</locationX>
        <locationY>455</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Supplier_Buyer_Map_null</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Supplier_Buyer_Map__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Update_Ops_Trustee</targetReference>
            </connector>
            <label>Supplier Buyer Map != null</label>
        </rules>
    </decisions>
    <decisions>
        <name>Check_for_Supplier_Buyer_Map_Account_Agent</name>
        <label>Check for Supplier Buyer Map - Account Agent</label>
        <locationX>336</locationX>
        <locationY>695</locationY>
        <defaultConnector>
            <targetReference>Phase_is_In_Progress</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Supplier_Buyer_Map_Account_Agent_null</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Supplier_Buyer_Map__r.Account_Agent__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Update_Agent_from_the_Map</targetReference>
            </connector>
            <label>Supplier Buyer Map - Account Agent != null</label>
        </rules>
    </decisions>
    <decisions>
        <name>Check_for_User_Availability_Mohd_Asif</name>
        <label>Check for User Availability - Mohd.Asif</label>
        <locationX>182</locationX>
        <locationY>2399</locationY>
        <defaultConnector>
            <targetReference>Get_User_Rish_Piilay</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Check_for_User_Availability_Mohd_Asif1</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_User_Mohd_Asif.Id</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Invoice_approved_by_Supplier</targetReference>
            </connector>
            <label>Check for User Availability - Mohd.Asif</label>
        </rules>
    </decisions>
    <decisions>
        <name>Check_for_User_Availability_Rish_Pillay</name>
        <label>Check for User Availability - Rish Pillay</label>
        <locationX>182</locationX>
        <locationY>2855</locationY>
        <defaultConnector>
            <targetReference>External_View_Equals_True</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Check_for_User_Availability_Rish_Pillay1</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_User_Rish_Piilay.Id</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Supplier_Approved_Invoice_Assign_to_Rish</targetReference>
            </connector>
            <label>Check for User Availability - Rish Pillay</label>
        </rules>
    </decisions>
    <decisions>
        <name>External_View_Equals_True</name>
        <label>External View Equals True</label>
        <locationX>336</locationX>
        <locationY>3287</locationY>
        <defaultConnector>
            <targetReference>Factoring_View</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>External_View_True</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.External_View__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_External_View_Recordtype</targetReference>
            </connector>
            <doesRequireRecordChangedToMeetCriteria>true</doesRequireRecordChangedToMeetCriteria>
            <label>External View = True</label>
        </rules>
    </decisions>
    <decisions>
        <name>Factoring_View</name>
        <label>Factoring View</label>
        <locationX>336</locationX>
        <locationY>3743</locationY>
        <defaultConnector>
            <targetReference>Reverse_Factoring_View</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Factoring_View1</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.External_View__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Product_type__c</leftValueReference>
                <operator>Contains</operator>
                <rightValue>
                    <stringValue>Reverse</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_Recordtype_Pricing_V2_2018</targetReference>
            </connector>
            <doesRequireRecordChangedToMeetCriteria>true</doesRequireRecordChangedToMeetCriteria>
            <label>Factoring View</label>
        </rules>
    </decisions>
    <decisions>
        <name>Funds_Available_Is_True</name>
        <label>Funds Available Is True</label>
        <locationX>336</locationX>
        <locationY>1823</locationY>
        <defaultConnector>
            <targetReference>Supplier_Approved_Invoice</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Funds_Available_True</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Funds_Available__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Send_Slack_Funds_Available</targetReference>
            </connector>
            <doesRequireRecordChangedToMeetCriteria>true</doesRequireRecordChangedToMeetCriteria>
            <label>Funds Available = True</label>
        </rules>
    </decisions>
    <decisions>
        <name>Phase_is_In_Progress</name>
        <label>Phase is In Progress</label>
        <locationX>336</locationX>
        <locationY>1031</locationY>
        <defaultConnector>
            <targetReference>Update_due_date_delta_bucket</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Phase_In_Progress</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Phase__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>3:IN PROGRESS</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Update_in_progress_date</targetReference>
            </connector>
            <doesRequireRecordChangedToMeetCriteria>true</doesRequireRecordChangedToMeetCriteria>
            <label>Phase == In Progress</label>
        </rules>
    </decisions>
    <decisions>
        <name>Ready_for_posting</name>
        <label>Ready for posting</label>
        <locationX>336</locationX>
        <locationY>4655</locationY>
        <defaultConnector>
            <targetReference>Waiting_for_Allocations_date</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Ready_for_posting1</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Invoice_ready_for_Posting__c</leftValueReference>
                <operator>IsChanged</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Invoice_ready_for_Posting__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Update_ready_for_posting_date</targetReference>
            </connector>
            <label>Ready for posting</label>
        </rules>
    </decisions>
    <decisions>
        <name>Reverse_Factoring_View</name>
        <label>Reverse Factoring View</label>
        <locationX>336</locationX>
        <locationY>4199</locationY>
        <defaultConnector>
            <targetReference>Ready_for_posting</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Reverse_Factoring_View1</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.External_View__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Product_type__c</leftValueReference>
                <operator>Contains</operator>
                <rightValue>
                    <stringValue>Standart</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_Auction_Product_Recordtype</targetReference>
            </connector>
            <doesRequireRecordChangedToMeetCriteria>true</doesRequireRecordChangedToMeetCriteria>
            <label>Reverse Factoring View</label>
        </rules>
    </decisions>
    <decisions>
        <name>Supplier_Approved_Invoice</name>
        <label>Supplier Approved Invoice</label>
        <locationX>336</locationX>
        <locationY>2159</locationY>
        <defaultConnector>
            <targetReference>External_View_Equals_True</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Supplier_ApprovalStatus_Approved</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Invoice_ready_for_Posting__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Waiting_for_allocations__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.supplier_approval_status__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Approved</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_User_Mohd_Asif</targetReference>
            </connector>
            <doesRequireRecordChangedToMeetCriteria>true</doesRequireRecordChangedToMeetCriteria>
            <label>Supplier ApprovalStatus = Approved</label>
        </rules>
    </decisions>
    <decisions>
        <name>Waiting_for_Allocations_date</name>
        <label>Waiting for Allocations date</label>
        <locationX>336</locationX>
        <locationY>5663</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Waiting_for_Allocations_date1</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Waiting_for_allocations__c</leftValueReference>
                <operator>IsChanged</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Waiting_for_allocations__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Update_Waiting_For_Allocation_Date</targetReference>
            </connector>
            <label>Waiting for Allocations date</label>
        </rules>
    </decisions>
    <description>Migration of Workflows for On Update Invoice Finance Deal.
1. Slack on new allocation
2. Funds Available
3. Supplier Approved Invoice
4. Activate external View
5. Factoring View
6. Reverse Factoring View
7. Ready for posting
8. Waiting for Allications date
9. Update invoice amount
10. Update due date delta bucket</description>
    <environments>Default</environments>
    <formulas>
        <name>DueDate</name>
        <dataType>Date</dataType>
        <expression>{!$Flow.CurrentDate} + 1</expression>
    </formulas>
    <formulas>
        <name>Invoice_ready_for_posting_Due_Date</name>
        <dataType>Date</dataType>
        <expression>{!$Flow.CurrentDate} + 1</expression>
    </formulas>
    <formulas>
        <name>InvoiceAmount</name>
        <dataType>Number</dataType>
        <expression>MIN({!$Record.Real_Face_Value__c}, {!$Record.funded_amount__c} / MIN( IF({!$Record.Supplier_Buyer_Map__r.Max_advance_amount_percentage__c} &gt; 0 , {!$Record.Supplier_Buyer_Map__r.Max_advance_amount_percentage__c}, 100), {!$Record.Supplier_Buyer_Map__r.percentage_of_financing__c} ) )</expression>
        <scale>2</scale>
    </formulas>
    <formulas>
        <name>ReadyForPostingDate</name>
        <dataType>Date</dataType>
        <expression>{!$Record.ready_for_posting_date__c} + 1</expression>
    </formulas>
    <interviewLabel>Invoice Finance Deal - {!$Flow.CurrentDateTime}</interviewLabel>
    <label>Invoice Finance Deal - On Update Actions</label>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>AUTO_LAYOUT_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>AutoLaunchedFlow</processType>
    <recordLookups>
        <name>Get_Auction_Product_Recordtype</name>
        <label>Get Auction Product Recordtype</label>
        <locationX>204</locationX>
        <locationY>4319</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Update_Auction_Product_Recordtype</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>SobjectType</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>invoice_finance_deal__c</stringValue>
            </value>
        </filters>
        <filters>
            <field>DeveloperName</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Auction_Product</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>RecordType</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_External_View_Recordtype</name>
        <label>Get External View Recordtype</label>
        <locationX>204</locationX>
        <locationY>3407</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Invoice_external_View_Activation</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>SobjectType</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>invoice_finance_deal__c</stringValue>
            </value>
        </filters>
        <filters>
            <field>DeveloperName</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>External_View</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>RecordType</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_Recordtype_Pricing_V2_2018</name>
        <label>Get Recordtype Pricing V2 2018</label>
        <locationX>204</locationX>
        <locationY>3863</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Update_Pricing_V2_2018_Recordtype</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>SobjectType</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>invoice_finance_deal__c</stringValue>
            </value>
        </filters>
        <filters>
            <field>DeveloperName</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Pricing_V2_2018</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>RecordType</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_User_Mohd_Asif</name>
        <label>Get User - Mohd. Asif</label>
        <locationX>182</locationX>
        <locationY>2279</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Check_for_User_Availability_Mohd_Asif</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Email</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>mohamed.asif@incomlend.com</stringValue>
            </value>
        </filters>
        <filters>
            <field>IsActive</field>
            <operator>EqualTo</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>User</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_User_Rish_Piilay</name>
        <label>Get User Rish Piilay</label>
        <locationX>182</locationX>
        <locationY>2735</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Check_for_User_Availability_Rish_Pillay</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Email</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>rish.pillay@incomlend.com</stringValue>
            </value>
        </filters>
        <filters>
            <field>IsActive</field>
            <operator>EqualTo</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>User</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordUpdates>
        <name>Invoice_external_View_Activation</name>
        <label>Invoice external View Activation</label>
        <locationX>204</locationX>
        <locationY>3527</locationY>
        <connector>
            <targetReference>Factoring_View</targetReference>
        </connector>
        <inputAssignments>
            <field>RecordTypeId</field>
            <value>
                <elementReference>Get_External_View_Recordtype.Id</elementReference>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Update_Agent_from_the_Map</name>
        <label>Update Agent from the Map</label>
        <locationX>204</locationX>
        <locationY>815</locationY>
        <connector>
            <targetReference>Phase_is_In_Progress</targetReference>
        </connector>
        <inputAssignments>
            <field>Agent_from_the_Map__c</field>
            <value>
                <elementReference>$Record.Supplier_Buyer_Map__r.Account_Agent__r.Name</elementReference>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Update_Auction_Product_Recordtype</name>
        <label>Update Auction Product Recordtype</label>
        <locationX>204</locationX>
        <locationY>4439</locationY>
        <connector>
            <targetReference>Ready_for_posting</targetReference>
        </connector>
        <inputAssignments>
            <field>RecordTypeId</field>
            <value>
                <elementReference>Get_Auction_Product_Recordtype.Id</elementReference>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Update_due_date_delta_bucket</name>
        <label>Update due date delta bucket</label>
        <locationX>336</locationX>
        <locationY>1367</locationY>
        <connector>
            <targetReference>Allocation_Number_Greater_than_0_and_Phase_is_Pre_Listing</targetReference>
        </connector>
        <inputAssignments>
            <field>due_date_delta_bucket_value__c</field>
            <value>
                <elementReference>$Record.due_date_delta_bucket__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>over_due_days_value__c</field>
            <value>
                <elementReference>$Record.over_due_days__c</elementReference>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Update_in_progress_date</name>
        <label>Update in progress date</label>
        <locationX>204</locationX>
        <locationY>1151</locationY>
        <connector>
            <targetReference>Update_due_date_delta_bucket</targetReference>
        </connector>
        <inputAssignments>
            <field>in_progress_date__c</field>
            <value>
                <elementReference>$Flow.CurrentDateTime</elementReference>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Update_Invoice_Amount1</name>
        <label>Update Invoice Amount</label>
        <locationX>534</locationX>
        <locationY>335</locationY>
        <connector>
            <targetReference>Check_for_supplier_buyer_map</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>advanced_amount__c</field>
            <operator>GreaterThan</operator>
            <value>
                <numberValue>0.0</numberValue>
            </value>
        </filters>
        <inputAssignments>
            <field>invoice_amount__c</field>
            <value>
                <elementReference>$Record.Invoice_Amount_Formula__c</elementReference>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Update_Ops_Trustee</name>
        <label>Update Ops, Trustee</label>
        <locationX>336</locationX>
        <locationY>575</locationY>
        <connector>
            <targetReference>Check_for_Supplier_Buyer_Map_Account_Agent</targetReference>
        </connector>
        <inputAssignments>
            <field>Invoice_Validation_Notes_for_OPs__c</field>
            <value>
                <elementReference>$Record.Supplier_Buyer_Map__r.invoice_validation_instructions_for_ops__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Public_Verification_Requirements__c</field>
            <value>
                <elementReference>$Record.Supplier_Buyer_Map__r.Public_Verification_Requirements__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Trustee__c</field>
            <value>
                <elementReference>$Record.Supplier_Buyer_Map__r.Trustee__c</elementReference>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Update_Pricing_V2_2018_Recordtype</name>
        <label>Update Pricing V2 2018 Recordtype</label>
        <locationX>204</locationX>
        <locationY>3983</locationY>
        <connector>
            <targetReference>Reverse_Factoring_View</targetReference>
        </connector>
        <inputAssignments>
            <field>RecordTypeId</field>
            <value>
                <elementReference>Get_Recordtype_Pricing_V2_2018.Id</elementReference>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Update_ready_for_posting_date</name>
        <label>Update ready for posting date</label>
        <locationX>182</locationX>
        <locationY>4775</locationY>
        <connector>
            <targetReference>Check_for_Asif_s_User</targetReference>
        </connector>
        <inputAssignments>
            <field>ready_for_posting_date__c</field>
            <value>
                <elementReference>$Flow.CurrentDate</elementReference>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Update_Waiting_For_Allocation_Date</name>
        <label>Update Waiting For Allocation Date</label>
        <locationX>204</locationX>
        <locationY>5783</locationY>
        <inputAssignments>
            <field>Waiting_for_Allocations_date__c</field>
            <value>
                <elementReference>$Flow.CurrentDate</elementReference>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <start>
        <locationX>408</locationX>
        <locationY>0</locationY>
        <connector>
            <targetReference>Update_Invoice_Amount1</targetReference>
        </connector>
        <filterFormula>!{!$Setup.ICL_Settings__c.Disable_Migrate_Flow__c}</filterFormula>
        <object>invoice_finance_deal__c</object>
        <recordTriggerType>CreateAndUpdate</recordTriggerType>
        <triggerType>RecordAfterSave</triggerType>
    </start>
    <status>Draft</status>
    <subflows>
        <name>Send_Slack_Allocation</name>
        <label>Send Slack Allocation</label>
        <locationX>204</locationX>
        <locationY>1607</locationY>
        <connector>
            <targetReference>Funds_Available_Is_True</targetReference>
        </connector>
        <flowName>send_slack_for_new_allocation_created</flowName>
        <inputAssignments>
            <name>invoiceID</name>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </inputAssignments>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </subflows>
    <subflows>
        <name>Send_Slack_Funds_Available</name>
        <label>Send Slack - Funds Available</label>
        <locationX>204</locationX>
        <locationY>1943</locationY>
        <connector>
            <targetReference>Supplier_Approved_Invoice</targetReference>
        </connector>
        <flowName>Send_Slack_when_Funds_available</flowName>
        <inputAssignments>
            <name>invoiceID</name>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </inputAssignments>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </subflows>
    <triggerOrder>400</triggerOrder>
</Flow>
